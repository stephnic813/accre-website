<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carousel template</title>
    <!-- Need iimport ung css ng swiper js -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"/>

    <style>
        .swiper-container {
            width: 100dvw;
            padding-top: 2em ;
            padding-bottom: 8em;
            text-align: center;
        }

        .swiper-slide {
            background-position: center;
            background-size: cover;
            width: 300px;
            height: 300px;
            -webkit-box-reflect: below 1px linear-gradient(transparent,transparent,#0006);
        }
    </style>
</head>
<body>
    <div class="swiper-container">
        <div class="swiper-wrapper">
            <!-- Update url ng mga img -->
            <!-- ung id ng mga swiper slide dito same dapat sa kung ano ung asa sa json -->
            <div class="swiper-slide" id="content-1" style="background-image: url(images/Extension-Community/Image1.JPG)"></div>
            <div class="swiper-slide" id="content-2"  style="background-image: url(images/Extension-Community//Image2.JPG)"></div>
            <div class="swiper-slide" id="content-3" style="background-image: url(images/Extension-Community//Image3.JPG)"></div>
            <div class="swiper-slide" id="content-4" style="background-image: url(images/Extension-Community//Image4.JPG)"></div>
            <div class="swiper-slide" id="content-5" style="background-image: url(images/Extension-Community//Image5.JPG)"></div>
        </div>
        <div class="swiper-pagination"></div>
    </div>
    <div>
      <!-- Lagay nalang dito ung content nung first slide ng carousel -->
        <h5 class="slide-content-title">Title of the Content 1</h5>
        <p class="slide-content">TEST 1 TEST 1 TEST 1 TEST 1 TEST 1 TEST 1 TEST 1 TEST 1 TEST 1 TEST 1 TEST 1 TEST 1 TEST 1 TEST 1 TEST 1</p>
    </div>

    <!-- Need iimport ung js ng swiper js -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    <script>
        var swiper = new Swiper('.swiper-container',{
          pagination: '.swiper-pagination',
          effect: 'coverflow',
          grabCursor: true,
          centeredSlides: true,
          slidesPerView: 'auto',
          coverflow:{
              rotate:20,
              stretch:0,
              depth:200,
              modifier:1,
              slideShadows:true,
          },
        });
    </script>

    <script>
        const slideToContent = new Map();
        const slides = document.querySelectorAll(".swiper-slide");
        let currentSlide = slides[0];
        const slideTitle = document.querySelector(".slide-content-title");
        const slideContent = document.querySelector(".slide-content");
        let json;

        caller();

        async function getJSON() {
            // Update nalang din relative path nung json if sa iba nakasave
            return fetch('./carousel-template.json')
            .then((response)=>response.json())
            .then((responseJson)=>{return responseJson});
        }
        
        async function caller() {
            json = await this.getJSON(); 

            for (const slide of slides) {
                slideToContent.set(slide.id, json[slide.id]);
            }

            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutationRecord) {
                    checkSlideChange();
                });    
            });
            const target = slides[0];
            observer.observe(target, { attributes : true, attributeFilter : ['style'] });
        }

        function checkSlideChange() {
            if (currentSlide.style.zIndex !== "1") {
                for (const slide of slides) {
                    if (slide.style.zIndex === "1") {
                        currentSlide = slide;
                        changeContents();
                        break;
                    }
                }
            }
        }

        function changeContents() {
            slideTitle.innerHTML = json[currentSlide.id]["title"];
            slideContent.innerHTML = json[currentSlide.id]["content"];
        }
    </script>
</body>
</html>
